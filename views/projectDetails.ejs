<link rel="stylesheet" href="../details.css" />
<!-- projectDetail.ejs -->

<div class="project-detail">
  <div>
    <h1><%= project.name %></h1>
    <p class="desc"><%= project.description %></p>
    <p class="author-name"><%= project.author %></p>
  </div>
</div>

<div id="hamburger">
  <div class="ham"></div>
  <div class="ham"></div>
  <div class="ham"></div>
</div>
<div class="issue_and_search">
  <!-- Search form -->
  <div class="search_filter" id="search_filter_id">
    <form
      id="search-form"
      action="/project/<%= project._id %>/search"
      method="get"
    >
      <input
        type="text"
        name="query"
        placeholder="Search by author or description"
        required
      />
      <button type="submit">
        <i class="fa-solid fa-magnifying-glass"></i>
      </button>
    </form>

    <!-- Existing code for displaying issues -->
    <div class="checks">
      <form action="/project/<%= project._id %>/filter" method="GET">
        <h4>Filter by Labels</h4>
        <ul>
          <li>
            <label>
              <input type="checkbox" name="labels" value="bug" /> Bug
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="documentation" />
              Documentation
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="enhancement" />
              Enhancement
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="help wanted" />
              Help wanted
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="good first issue" />
              Good first issue
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="question" />Question
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="wontfix" />Wontfix
            </label>
          </li>
          <li>
            <label>
              <input type="checkbox" name="labels" value="invalid" />Invalid
            </label>
          </li>
        </ul>
        <!-- Add more checkboxes for other labels -->

        <button type="submit" class="filter-btn">Apply Filter</button>
      </form>
    </div>
  </div>
  <div class="issue-container">
    <ul>
      <% project.issues.forEach((issue) => { %>
      <li>
        <div>
          <h3><%= issue.name %></h3>
          <p><%= issue.description %></p>
          <p
            style="
              background-color: rgba(128, 128, 128, 0.322);
              width: fit-content;
              padding: 0 5px;
              border-radius: 5px;
            "
          >
            <%= issue.author %>
          </p>
        </div>
        <div>
          <p>Label: <%= issue.labels %></p>
        </div>
      </li>
      <% }); %>
    </ul>
  </div>

  <div class="btn">
    <a href="/project/<%= project.id %>/issue_form">Create Issue</a>
  </div>
</div>

<script>
  const hamburger = document.getElementById("hamburger");
  const searchFilter = document.getElementById("search_filter_id");

  hamburger.addEventListener("click", () => {
    if (searchFilter.style.display === "none") {
      searchFilter.style.display = "block";
    } else {
      searchFilter.style.display = "none";
    }
  });
</script>
